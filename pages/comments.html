---
layout: selectors
title: Comments
permalink: /comments
---

<div class="flex flex-col sm:flex-row m-8 mt-12 pt-8 py-4 min-h-screen border-b-2 border-dashed border-grey-dark overflow-hidden">
  <div class="sm:w-1/2 p-8 overflow-hidden">
    <h2 class="mb-8">Comments/Attachments examples</h2>

    <div class="comment-field">
      <div class="comment-field__action comment-field__attach">
        <div class="inline-action primary"><input name="upload" type="file" class="file-input" tabindex="-1"></div>
      </div>
      <div class="comment-field__input comment-field__input--empty">
        <textarea placeholder="Use @ to notify person"></textarea>
        <div class="fake-input"></div>
      </div>
      <div class="comment-field__action comment-field__send opacity-0">
        <div class="inline-action primary"></div>
      </div>
    </div>

    <div class="comment-field">
      <div class="comment-field__action comment-field__attach">
        <div class="inline-action JS_remove_comment"></div>
      </div>
      <div class="comment-field__input">
        <a href="#" class="comment-field__attachment">
          <div class="comment-field__attachment-thumbnail" style="background-image:url('./assets/images/screenshot.png');"></div>
          <div class="comment-field__attachment-label h2 hidden">jpg</div>
        </a>
        <textarea placeholder="Use @ to notify person">Please read acceptence criterias,</textarea>
        <div class="fake-input">Please read acceptence criterias,</div>
      </div>
      <div class="comment-field__action comment-field__send opacity-0">
        <div class="inline-action primary"></div>
      </div>
    </div>

    <div class="comment-field">
      <div class="comment-field__action comment-field__attach">
        <div class="inline-action JS_remove_comment"></div>
      </div>
      <div class="comment-field__input">
        <textarea placeholder="Use @ to notify person" style="height: 100px;">Please read acceptence criterias, @KonstantinKharlov and you can find the layout of these stories on http://devcenter.tenforce.com/mockups/ along with the @desired effects when clicking the 'menu' and 'account' icons, and the tabs navigation. please do not look at the main content layout, @since these are not at all anything final.</textarea>
        <div class="fake-input"></div>
      </div>
      <div class="comment-field__action comment-field__send opacity-0">
        <div class="inline-action primary"></div>
      </div>
    </div>

    <div class="comment-post">
      <div class="comment-post__label">
        <div class="h8"><span class="primary inline-action">Jetro Wils</span> at <span>15:16</span></div>
      </div>
      <div class="comment-post__value">
        <div class="comment-post__bubble">
          <a href="#" class="comment-post__bubble-attachment">
            <div class="comment-post__bubble-attachment-thumbnail" style="background-image:url('./assets/images/screenshot.png');"></div>
          </a>
          <div class="comment-post__bubble-message">
            <a href="#" class="inline-action">@nickdejaeger</a> Important notes:
            <br><br>
            - Fixing integration tests: 30 tests failing<br>
            - We fixed 3 since yesterday<br>
            - Ward is working on this. Except to finish this week.<br>
            - Functional: the URI must be in sync with the content panel
          </div>
        </div>
      </div>
    </div>

    <div class="comment-post comment-post--self">
      <div class="comment-post__label">
        <div class="h8"><span class="primary inline-action">Nick De Jaeger</span> at <span>14:60</span></div>
      </div>
      <div class="comment-post__value">
        <div class="comment-post__bubble">
          <div class="comment-post__bubble-message">
            <a href="#" class="inline-action">@jetro</a> Send me screenshot please
          </div>
        </div>
      </div>
    </div>

  </div>
  <div class="sm:w-1/2 p-8 overflow-hidden">
    <h2 class="mb-8">Test comment/att posts</h2>

    <div class="relative">

      <div class="comment-field JS_comment_post">
        <div class="comment-field__action comment-field__attach">
          <div class="inline-action primary"><input name="upload" type="file" class="file-input" tabindex="-1"></div>
        </div>
        <div class="comment-field__input comment-field__input--empty">
          <textarea placeholder="Use @ to notify person"></textarea>
          <div class="fake-input"></div>
        </div>
        <div class="comment-field__action comment-field__send opacity-0">
          <div class="inline-action primary"></div>
        </div>
      </div>

      <div id="comments-container">

        <!--
          @source: https://tracker.tenforce.com/workspace/383/83172f/561531#commentsAndAttachments
        -->

        <div class="comments-seperator">
          <span class="h8">Last month</span>
        </div>

        <div class="comment-post comment-post--self">
          <div class="comment-post__label">
            <div class="h8 text-grey-dark"><span class="inline-action primary">Jan Van den Nieuwenhof</span> at <span>06/06/2018</span> <span>10:15</span></div>
          </div>
          <div class="comment-post__value">
            <div class="comment-post__bubble">
              <div class="comment-post__bubble-message">
                <a href="#" class="inline-action primary">@Sara</a>, <a href="#" class="inline-action primary">@Kasper</a>,<br>
                idem voor deze. Deze mag bijna afgesloten worden (nog een upload of iets dergelijks)<br>
                Beter dat dit bij iemand zit , anders verdwijnt dit van de to-do lijstjes
              </div>
            </div>
            <div class="comment-post__action">
              <div class="inline-action primary"></div>
            </div>
          </div>
        </div>

        <div class="comments-seperator">
          <span class="h8">Last year</span>
        </div>

        <div class="comment-post">
          <div class="comment-post__label">
            <div class="h8 text-grey-dark"><span class="inline-action primary">André Terhorst</span> at <span>15/07/2017</span> <span>13:40</span></div>
          </div>
          <div class="comment-post__value">
            <div class="comment-post__bubble">
              <div class="comment-post__bubble-message">
                <a href="#" class="inline-action primary">@Nathalie</a>, <a href="#" class="inline-action primary">@Jan</a>,<br>
                Ja normaal mag dit naar projecten, maar laat voorlopig nog maar even staan als SR.<br>
                Er zijn nog een aantal SR's die we misschien hiermee kunnen combineren in 1 project, maar Lanxess heeft aangegeven dat deze nog niet voor korte termijn zijn.<br>
                Zodra ze concreet bestellen kunnen we er dan een project van maken.
              </div>
            </div>
            <div class="comment-post__action">
              <div class="inline-action unselected"></div>
            </div>
          </div>
        </div>

        <div class="comment-post comment-post--history">
          <div class="comment-post__label">
            <div class="h8 text-grey-dark"><span class="inline-action primary">System Administrator</span> at <span>08/09/2017</span> <span>13:31</span></div>
          </div>
          <div class="comment-post__value">
            <div class="comment-post__bubble">
              <div class="comment-post__bubble-message">
                Set status from examined to confirmed
              </div>
            </div>
          </div>
        </div>

        <div class="comment-post">
          <div class="comment-post__label">
            <div class="h8 text-grey-dark"><span class="inline-action primary">Nathalie Poot</span> at <span>15/07/2017</span> <span>12:46</span></div>
          </div>
          <div class="comment-post__value">
            <div class="comment-post__bubble">
              <div class="comment-post__bubble-message">
                <a href="#" class="inline-action primary">@André</a>, <a href="#" class="inline-action primary">@Jan</a>,<br>
                <br>
                Dit staat bij de service requests, maar moet dit niet verschoven worden naar projecten (omw van het aantal MD)?<br>
                <br>
                Dank je<br>
                <br>
                groetjes
              </div>
            </div>
            <div class="comment-post__action">
              <div class="inline-action unselected"></div>
            </div>
          </div>
        </div>

        <div class="comment-post comment-post--self">
          <div class="comment-post__label">
            <div class="h8 text-grey-dark"><span class="inline-action primary">Jan Van den Nieuwenhof</span> at <span>11/05/2017</span> <span>15:29</span></div>
          </div>
          <div class="comment-post__value">
            <div class="comment-post__bubble">
              <div class="comment-post__bubble-message">
                <a href="#" class="inline-action primary">@Sandra</a>, <a href="#" class="inline-action primary">@Hugo</a>,<br>
                <br>
                Inderdaad ik zou er dit van maken<br>
                <br>
                7 dagen config + scripting<br>
                2 dagen follow-up en pm<br>
                1 dag installatie en productie support<br>
                in regie - excel import afhankelijk van excels en formaten (tss 4 - 8 dagen?)<br>
                <br>
                mvg<br>
                Jan
              </div>
            </div>
            <div class="comment-post__action">
              <div class="inline-action primary"></div>
            </div>
          </div>
        </div>

        <div class="comment-post">
          <div class="comment-post__label">
            <div class="h8 text-grey-dark"><span class="inline-action primary">Sandra Ghysels</span> at <span>09/05/2017</span> <span>10:45</span></div>
          </div>
          <div class="comment-post__value">
            <div class="comment-post__bubble">
              <div class="comment-post__bubble-message">
                <a href="#" class="inline-action primary">@jan_van_den_nieuwenhof</a>, <a href="#" class="inline-action primary">@hugo_daninck</a>,<br>
                <br>
                vraag van Lanxess voor fixed price implementatie van "Asbest"<br>
                <br>
                Ingesloten hun specs (pdf) en mijn voorstel (doc), ik kom op 7 dagen config + scripting, mag nog wat pm over + testing<br>
                <br>
                Graag inschatting bekijken want ze willen fixed price omdat iAdvise ook fixed price heeft voorgesteld.<br>
                NIet vergeten dat er ook nog een 8 of 10 dagen bij kwam voor de import van de xls files per bedrijf, die heb ik er niet bijgezet want ik weet niet meer of het 8 of 10 bedrijven zijn.<br>
                <br>
                Sandra
              </div>
            </div>
            <div class="comment-post__action">
              <div class="inline-action text-green disabled"></div>
            </div>
          </div>
        </div>

      </div><!-- /#comments-container -->

    </div>

  </div>
</div>

<!-- Comments/Attachments SCRIPT -->
<script>
  // init with delay (due slow html load)
  setTimeout(function() {
    checkContentInput();
    checkFakeInputHeight();

    // Not working (find a way to trigger focus over fake-input because @<notifed> links need to be clickable)
    $('.fake-input span').each(function() {
      $(this).on('click', function() {
        console.log('clicked span');
        $(this).closest('.comment-field__input').find('textarea').trigger('focusin');
      });
    });
  }, 3000);

  $(window).on('resize', function() {
    checkFakeInputHeight();
  });


  $('body').on('focusin', '.comment-field__input textarea', function() {
    $('.overlay-body').addClass('opacity-100');
    $(this).closest('.comment-field').addClass('comment-field--focus');
    $(this).closest('.comment-field').find('.comment-field__send').addClass('opacity-100');
  });

  $('body').on('focusout', '.comment-field__input textarea', function() {
    $('.overlay-body').removeClass('opacity-100');
    $(this).closest('.comment-field').removeClass('comment-field--focus');
    checkContentInput();
    checkFakeInputHeight();
  });

  $('body').on('keyup', '.comment-field__input textarea', function() {
    if ($(this).val().length > 0) {
      $(this).closest('.comment-field').find('.comment-field__attach .inline-action').addClass('JS_remove_comment').html('');
    }
    else {
      $(this).closest('.comment-field').find('.comment-field__attach .inline-action').removeClass('JS_remove_comment').html('<input name="upload" type="file" class="file-input" tabindex="-1">');
      $(this).closest('.comment-field').find('.comment-field__attachment').remove();
    }

    checkContentInput();
    checkFakeInputHeight();
  });

  $('body').on('change', 'input[type=file]', function () {
    var filePath = $(this).val();
    var fileName = filePath.substring(filePath.lastIndexOf("\\") + 1, filePath.length);
    var fileExtension = filePath.substring(filePath.lastIndexOf(".") + 1, filePath.length);
    $(this).closest('.comment-field').find('.comment-field__send').addClass('opacity-100');
    $(this).closest('.comment-field').find('.comment-field__input').removeClass('comment-field__input--empty').prepend('<a href="#'+fileName+'" class="comment-field__attachment"><div class="comment-field__attachment-thumbnail" style="background-image:url(./assets/images/screenshot.png);"></div><div class="comment-field__attachment-label h2 hidden">'+fileExtension+'</div></a>');
    $(this).closest('.comment-field').find('.comment-field__input textarea').val(fileName);
    $(this).closest('.comment-field').find('.fake-input').html(fileName);
    $(this).closest('.comment-field').find('.comment-field__attach .inline-action').addClass('JS_remove_comment').html('');
  });

  $('body').on('click', '.JS_remove_comment', function() {
    $(this).closest('.comment-field').find('.comment-field__attach .inline-action').removeClass('JS_remove_comment').html('<input name="upload" type="file" class="file-input" tabindex="-1">');
    $(this).closest('.comment-field').find('.comment-field__attachment').remove();
    $(this).closest('.comment-field').find('.comment-field__input textarea').val('');

    checkContentInput();
    checkFakeInputHeight();
  });

  function checkFakeInputHeight() {
    $('.comment-field').each(function() {
      var textarea = $(this).find('.comment-field__input textarea');
      var fakeInput = $(this).find('.fake-input');

      textarea.css({
        'height': fakeInput.height() + 'px'
      });
    });

    $('.comment-post__bubble').each(function() {
      if ( $(this).height() >= 200 ) {
        $(this).addClass('comment-post__bubble--overflow');

        $(this).append('<div class="readmore JS_readmore"></div>')
      }
      else {
        $(this).removeClass('comment-post__bubble--overflow');

        $(this).find('.readmore').remove();
      }
    });
  }

  function checkContentInput() {
    $('.comment-field').each(function() {
      var textarea = $(this).find('.comment-field__input textarea');
      var notified = textarea[0].value.match(/@[a-z]+/gi);
      var newval = textarea[0].value;

      if (textarea[0].value.length > 0) {
        $(this).find('.comment-field__input').removeClass('comment-field__input--empty');
        $(this).find('.comment-field__send').addClass('opacity-100');

          // turn @<notified> into links
          if (notified != null && notified.length > 0) {
            for (var i = 0; i < notified.length; i++) {
              newval = newval.replace(notified[i], '</span><a href="#'+notified[i]+'" class="inline-action primary">' + notified[i] + '</a><span>');
            }
          }
          newval = newval.replace(newval, '<span>' + newval + '</span>');
          $(this).find('.fake-input').html(newval);
      }
      else {
        $(this).find('.comment-field__input').addClass('comment-field__input--empty');
        $(this).find('.comment-field__send').removeClass('opacity-100');
        $(this).find('.fake-input').empty();
      }
    });
  }

  $('.JS_comment_post').each(function() {
    var hasFile = false;

    $(this).on('change', 'input[type=file]', function() {
      hasFile = true;
    });

    $(this).on('click', '.comment-field__send', function() {
      var textarea = $(this).closest('.comment-field').find('.comment-field__input textarea');
      var notified = textarea[0].value.match(/@[a-z]+/gi);
      var newval = textarea[0].value;
      var day = new Date().getDate();
      var month = new Date().getMonth();
      var year = new Date().getFullYear();
      var time = new Date().toLocaleTimeString('en-US', { hour12: false, hour: "numeric", minute: "numeric"});

      if ( textarea.val().length > 0 ) {
        // turn @<notified> into links
        if (notified != null && notified.length > 0) {
          for (var i = 0; i < notified.length; i++) {
            newval = newval.replace(notified[i], '</span><a href="#'+notified[i]+'" class="inline-action primary">' + notified[i] + '</a><span>');
          }
        }

        if (hasFile) {
          $('#comments-container').prepend(
            '<div class="comment-post comment-post--self">' +
              '<div class="comment-post__label">' +
                '<div class="h8"><span class="inline-action primary">Jan Van den Nieuwenhof</span> at <span>' + day + '/' + month + '/' + year + '</span> <span>' + time + '</span></div>' +
              '</div>' +
              '<div class="comment-post__value">' +
                '<div class="comment-post__bubble">' +
                  '<a href="#" class="comment-post__bubble-attachment">' +
                    '<div class="comment-post__bubble-attachment-thumbnail" style="background-image:url(./assets/images/screenshot.png);"></div>' +
                  '</a>' +
                  '<div class="comment-post__bubble-message">' +
                    newval +
                  '</div>' +
                '</div>' +
                '<div class="comment-post__action">' +
                  '<div class="inline-action primary"></div>' +
                '</div>' +
              '</div>' +
            '</div>'
          );
        }
        else {
          $('#comments-container').prepend(
            '<div class="comment-post comment-post--self">' +
              '<div class="comment-post__label">' +
                '<div class="h8"><span class="inline-action primary">Jan Van den Nieuwenhof</span> at <span>' + day + '/' + month + '/' + year + '</span> <span>' + time + '</span></div>' +
              '</div>' +
              '<div class="comment-post__value">' +
                '<div class="comment-post__bubble">' +
                  '<div class="comment-post__bubble-message">' +
                    newval +
                  '</div>' +
                '</div>' +
                '<div class="comment-post__action">' +
                  '<div class="inline-action primary"></div>' +
                '</div>' +
              '</div>' +
            '</div>'
          );
        }

        $(this).closest('.comment-field').find('.comment-field__attach .inline-action').removeClass('JS_remove_comment').html('<input name="upload" type="file" class="file-input" tabindex="-1">');
        $(this).closest('.comment-field').find('.comment-field__attachment').remove();
        $(this).closest('.comment-field').find('.comment-field__input textarea').val('');

        checkContentInput();
        checkFakeInputHeight();
      }
      else {
        $(this).closest('.comment-field').find('.comment-field__input').addClass('animate-popup');

        setTimeout(function() {
          $('.comment-field__input').removeClass('animate-popup');
        }, 1000);
      }

      hasFile = false;
    });
  });

  $('body').on('click', '.JS_readmore', function() {
    $(this).closest('.comment-post__bubble').removeClass('comment-post__bubble--overflow').css({
      'max-height': '100%'
    });
  });
</script>
